# Alist v3.39.4 一键降级/部署脚本【Nuro定制】

## 前言

由于某些原因，个人不得不将 Alist 降级到指定版本（如 v3.39.4），并希望能够方便管理 Alist 的安装、重置密码、端口调整等，遂编写此一键脚本。  
**本脚本仅适用于二进制本地部署的 Alist，不适用于 Docker 方式。**

---

## ✨ 功能亮点

- 一键自动安装 Alist（默认 v3.39.4，也可自定义下载链接）
- 强制降级（支持指定 tar.gz 链接）
- 自动检测并显示服务状态、版本、端口等
- 支持直接重置管理员密码（兼容新版单账号逻辑）
- 支持一键卸载/重启/端口更改
- 完全基于 bash，无需第三方依赖

---

## 🚀 安装与使用

### 1. 下载并执行脚本（推荐 root 用户）

```bash
bash <(curl -fsSL https://raw.githubusercontent.com/nuro-hia/nurohia-alist/main/install.sh)
```

> 建议以 `root` 用户执行，以确保有权限操作 systemd 服务、安装目录等。

---

### 2. 功能菜单介绍

运行脚本后，将进入如下交互菜单：

```
===== Nuro · Alist 一键部署&管理菜单 =====
===== 安装、强制降级默认为 v3.39.4 版本 =====

1) 安装 Alist
2) 强制降级Alist 版本
3) 查看当前运行状态
4) 查看当前 Alist 版本
5) 重启 Alist 服务
6) 停止 Alist 服务
7) 卸载 Alist
8) 重置管理员密码
9) 更改面板端口
10) 快速显示访问地址
11) 退出
=======================================
```

**主要功能说明：**

- 1 安装 Alist（可自定义安装包链接，留空即为默认 v3.39.4）
- 2 强制降级到 v3.39.4 或自定义版本（输入下载链接，否则为默认）
- 3~6 各类运行状态、重启、停止
- 7 卸载（含数据，谨慎操作）
- 8 重置管理员密码为 123456（新版会自动检测管理员名并输出）
- 9 更改 Web 面板端口（支持 4~5 位端口号）
- 10 快速显示访问地址

---

## 📁 部署相关说明

- **安装目录**：`/opt/alist`
- **数据目录**：`/opt/alist/data/`
- **服务名称**：`alist`（systemd 管理）
- **默认端口**：`5244`，可通过菜单修改

---

## 📝 常见问题

### Q1：降级/升级后无法登录？

A：重置密码后建议刷新网页并用提示的新密码登录。如果密码无效，请重启服务或使用菜单8再重置一次。

---

### Q2：脚本不适用于哪些场景？

A：本脚本不适用于**Docker 或 Docker Compose** 部署的 Alist，请使用容器自己的管理命令。

---

### Q3：出现 `[del_user_cache_online] failed` 警告怎么办？

A：只要服务未运行时重置密码，会有这个 warning，但密码**实际已写入数据库**，无须理会。只要重启服务后用 123456 登录即可。

---

### Q4：管理员账号名不是 admin 怎么办？

A：新版脚本会自动检测出当前管理员用户名并重置密码，无论你改没改用户名，都能正确输出账号名。

---

## ⚠️ 免责声明

- 本脚本由 NuroHia 个人学习研究用途编写，**仅供自用测试**。
- 由此引发的任何数据损坏、服务不可用等后果，作者不承担任何责任。
- 请勿用于非法用途，若有 bug 可反馈 issue，但请勿商用。

---

## 🛠️ 反馈与交流

如有疑问或建议，欢迎通过 GitHub issue 反馈。

---

**祝你顺利管理 Alist！如遇卡壳欢迎来 issue 留言！**
